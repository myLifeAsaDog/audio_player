webpackJsonp([1],{NHnr:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("7+uW"),i=t("Xxa5"),o=t.n(i),r=t("exGp"),s=t.n(r),u=function(e){var n=Math.ceil(e),t=Math.floor(n/60);return{min:t,sec:n-60*t}},d={name:"time-count",props:{current:Number,duration:Number},computed:{elapsedTime:function(){return u(this.current)},durationTime:function(){return u(this.duration)}},filters:{zeroPadding:function(e){return("00"+e).slice(-2)}}},l={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",{staticClass:"time-display"},[t("p",[e._v(e._s(e._f("zeroPadding")(e.elapsedTime.min))+":"+e._s(e._f("zeroPadding")(e.elapsedTime.sec))+" / "+e._s(e._f("zeroPadding")(e.durationTime.min))+":"+e._s(e._f("zeroPadding")(e.durationTime.sec)))]),e._v(" "),t("meter",{attrs:{value:e.current,min:"0",max:e.duration}})])},staticRenderFns:[]},c={name:"index",components:{TimeCount:t("VU/8")(d,l,!1,null,null,null).exports},computed:{visualizerSize:function(){return 21},buttonLabel:function(){return this.isPlaying?"PAUSE":"PLAY"}},data:function(){return{audioContext:null,source:null,decodedAudioBuffer:{sampleRate:0,duration:0,numberOfChannels:0},elapsedTime:0,offsetTme:0,gainNode:null,panNode:null,analyserNode:null,canvasContext:null,isPlaying:!1,currentTimeId:null,visualizerId:null}},created:function(){this.initialize()},mounted:function(){this.canvasContext=this.$refs.visualizer.getContext("2d")},methods:{initialize:function(){this.audioContext=new AudioContext,this.audioContext.suspend(),this.createGain(),this.createPan(),this.createAnalyser()},createGain:function(){this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=.3,this.gainNode.connect(this.audioContext.destination)},createPan:function(){this.panNode=this.audioContext.createStereoPanner(),this.panNode.pan.value=0,this.panNode.connect(this.audioContext.destination)},createAnalyser:function(){this.analyserNode=this.audioContext.createAnalyser(),this.analyserNode.fftSize=64,this.analyserNode.connect(this.audioContext.destination)},getCurrentTime:function(){this.elapsedTime>this.decodedAudioBuffer.duration&&(this.offsetTme=this.offsetTme+this.decodedAudioBuffer.duration),this.elapsedTime=Math.ceil(this.audioContext.currentTime-this.offsetTme),this.currentTimeId=requestAnimationFrame(this.getCurrentTime)},loadAudio:function(e){var n=this;return s()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.audioContext.decodeAudioData(e);case 2:n.decodedAudioBuffer=t.sent,console.log(n.audioContext),n.source=n.audioContext.createBufferSource(),n.source.buffer=n.decodedAudioBuffer,n.source.loop=!0,n.source.loopEnd=n.decodedAudioBuffer.duration,n.source.playbackRate.value=1,n.source.connect(n.gainNode).connect(n.panNode).connect(n.analyserNode).connect(n.audioContext.destination),n.source.start(),n.audioContext.resume(),n.getCurrentTime(),n.offsetTme=n.audioContext.currentTime,n.renderCanvas(),n.isPlaying=!0;case 16:case"end":return t.stop()}},t,n)}))()},renderCanvas:function(){var e=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(e);var n=this.$refs.visualizer.height,t=this.$refs.visualizer.width;this.canvasContext.clearRect(0,0,t,n),this.canvasContext.fillStyle="#2e8b57";for(var a=0;a<21;a++){var i=e[a]/3;this.canvasContext.fillRect(11*a,n-i,10,i)}this.visualizerId=requestAnimationFrame(this.renderCanvas)},handleVolume:function(e){this.gainNode.gain.value=e.target.value},handlePan:function(e){this.panNode.pan.value=e.target.value},handleCickResumeAndSuspend:function(){console.log(this.source),"suspended"===this.audioContext.state?(this.audioContext.resume(),this.isPlaying=!0):(this.audioContext.suspend(),this.isPlaying=!1)},handleFileChange:function(e){var n=this,t=new FileReader;t.readAsArrayBuffer(e.target.files[0]),t.onload=function(){n.source&&(n.source.stop(),cancelAnimationFrame(n.currentTimeId),cancelAnimationFrame(n.visualizerId));var e=t.result;n.loadAudio(e)}}}},f={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("main",{attrs:{role:"main"}},[t("canvas",{ref:"visualizer",attrs:{width:"230",height:"100"}}),e._v(" "),t("TimeCount",{attrs:{current:e.elapsedTime,duration:e.decodedAudioBuffer.duration}}),e._v(" "),t("button",{attrs:{type:"button"},on:{click:e.handleCickResumeAndSuspend}},[e._v(e._s(e.buttonLabel))]),e._v(" "),t("p",[t("input",{attrs:{type:"file",accept:"audio/*"},on:{change:e.handleFileChange}})]),e._v(" "),t("div",[t("label",{attrs:{for:"volume"}},[e._v("volume")]),e._v(" "),t("input",{attrs:{type:"range",name:"volume",min:"0",max:"1",step:"0.1"},domProps:{value:e.gainNode.gain.value},on:{change:e.handleVolume}}),e._v(" "),t("span",[e._v(e._s(Math.floor(100*e.gainNode.gain.value))+"/100")])]),e._v(" "),t("div",[t("label",{attrs:{for:"pan"}},[e._v("pan")]),e._v(" "),t("input",{attrs:{type:"range",name:"pan",min:"-1",max:"1",step:"0.1"},domProps:{value:e.panNode.pan.value},on:{change:e.handlePan}}),e._v(" "),t("span",[e._v(e._s(Math.floor(100*e.panNode.pan.value)))])])],1)},staticRenderFns:[]},h={name:"App",components:{Index:t("VU/8")(c,f,!1,null,null,null).exports}},m={render:function(){var e=this.$createElement,n=this._self._c||e;return n("div",{attrs:{id:"app"}},[n("Index")],1)},staticRenderFns:[]};var p=t("VU/8")(h,m,!1,function(e){t("UAsH")},null,null).exports;a.a.config.productionTip=!1,new a.a({el:"#app",components:{App:p},template:"<App/>"})},UAsH:function(e,n){}},["NHnr"]);
//# sourceMappingURL=app.cdef6f1c716b985bb551.js.map